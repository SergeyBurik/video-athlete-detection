# video-athlete-detection

# Детекция и отслеживание спортсмена
## Основная цель — автоматически:
1. находить спортсмена на видео (предварительно неизвестно, где находится спортсмен);
2. отслеживать перемещение спортсмена на протяжении всего видео, даже с учетом смены ракурсов
съемки;
3. проводить эстимацию описывающей коробки и 2Д скелета.
Требуется:
• выбрать метод автоматического поиска спортсмена (и только его);
• выбрать метод трекинга спортсмена;
• выбрать метод эстимации описывающей коробки и 2D скелета человека;
• реализовать пайплайн инференса системы.

Ниже приведены **два** решения задачи.

**Первое** использует модель **Grounding DINO**, которая находит спортсмена по **текстовому описанию**. Модель работает с минимальным количеством ложных детекций и демонстрирует **стабильно точные результаты**, однако каждый вызов этой модели длится дольше, чем более легковесные аналоги вроде YOLO.

**Второе** решение является **оптимизированной версией** первого решения. В нем **минимизируется количество вызовов** модели Grounding DINO. Эта модель вызывается всего 2 раза в секунду. Bounding boxes этой модели являются опорой для **более быстрой модели** YOLO (или любой аналогичной модели).

## Решение 1
Это решение реализует систему автоматического **обнаружения, отслеживания и оценки позы спортсмена на видео**.

Оно использует модель **Grounding DINO** для детекции по текстовому описанию с частотой 5 раз в секунду.
Затем активируется **трекер CSRT**, поддерживающий отслеживание спортсмена в промежутках **между детекциями**.

Для повышения скорости детекция выполняется на **уменьшенной копии кадра**, а координаты масштабируются обратно.

Если объект **успешно детектирован** или оттрекан, производится **обрезка** соответствующей **области**, на которую затем применяется модель YOLO **для оценки позы**.

Полученные ключевые точки отображаются на оригинальном кадре в **виде красных точек**.

Готовое видео записывается **в выходной файл**. Также в коде учитывается возможность работы на GPU с использованием смешанной точности для ускорения вычислений.

## Решение 2
Данное решение является оптимизированной версией прошлого подхода. 

В процессе работы производится **либо первичная детекция** с помощью модели **Grounding DINO**, **либо уточнение** и обновление локализации спортсмена с помощью модели YOLO (или любой другой легковесной модели).

**Grounding DINO** запускается **с низкой частотой** и выполняет обнаружение объектов на основе текстовых описаний, при этом обработка происходит на уменьшенной копии кадра для ускорения работы. Найденные координаты масштабируются обратно к исходному размеру изображения.

В промежутках **между вызовами DINO**, модель **YOLO** применяется для **дообнаружения** или **уточнения** позиции спортсмена **в ограниченной области** вокруг **предыдущей детекции**.

Эта **область расширяется** по горизонтали и вертикали на заданное значение, чтобы обеспечить **более устойчивое обнаружение**.

Если YOLO успешно находит человека, его координаты сохраняются и используются **для последующей обработки**.

После того как регион спортсмена определён, он обрезается, и на него запускается **модель оценки поз YOLO Pose**, которая определяет **ключевые точки тела**.

Эти ключевые точки наносятся на исходный кадр в виде красных точек. Обработанные кадры записываются **в выходное видео**.

![example1](https://github.com/user-attachments/assets/f17883f9-f5f2-40c5-a0c3-07639893c5ff)
![example2](https://github.com/user-attachments/assets/9beb311f-9cb2-4631-8a1f-d12222458eb2)
![example3](https://github.com/user-attachments/assets/afb86ae9-224a-4466-8b7d-a2177c9b20d2)
![example4](https://github.com/user-attachments/assets/a84bc3b5-6253-4091-97de-73c5441c531d)

## Больше примеров в output_examples


